<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Painel — Empório Fernandes</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="icon" type="image/png" href="img/id/favicon-32x32.png">
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

<!-- Topo -->
<header class="flex justify-between items-center px-6 py-4 bg-white shadow">
  <div class="flex items-center space-x-2">
    <img src="img/id/logo.png" alt="Logo" class="h-10">
    <h1 class="font-bold text-lg" style="color: rgb(36,59,151);">Empório Fernandes</h1>
  </div>
</header>

<!-- Navegação Abas -->
<div class="flex justify-center mt-4 space-x-4">
  <button id="btn-produtos" class="px-4 py-2 font-semibold rounded" style="background: rgb(253,219,87); color: rgb(36,59,151);">Produtos</button>
  <button id="btn-pedidos" class="px-4 py-2 font-semibold rounded bg-white border" style="border-color: rgb(36,59,151); color: rgb(36,59,151);">Pedidos</button>
</div>

<main class="flex-1 p-6 max-w-6xl mx-auto">

  <!-- Produtos -->
  <div id="aba-produtos">
    <div class="flex justify-end mb-4">
      <button onclick="abrirPopup()" class="px-4 py-2 rounded font-semibold"
        style="background: rgb(253,219,87); color: rgb(36,59,151);">
        + Adicionar Produto
      </button>
    </div>
    <div id="lista-produtos" class="grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"></div>
  </div>

  <!-- Pedidos -->
  <div id="aba-pedidos" class="hidden">
    <h2 class="text-2xl font-bold mb-4" style="color: rgb(36,59,151);">Pedidos Pendentes</h2>
    <div id="pedidos-pendentes" class="space-y-4 mb-8"></div>

    <h2 class="text-2xl font-bold mb-4" style="color: rgb(36,59,151);">Pedidos Confirmados</h2>
    <div id="pedidos-confirmados" class="space-y-4"></div>
  </div>

</main>

<!-- Popup Novo Produto -->
<div id="popup" class="fixed inset-0 bg-black/50 hidden flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-xl w-full max-w-md shadow-lg">
    <h3 class="text-xl font-semibold mb-4" style="color: rgb(36,59,151);">Novo Produto</h3>
    <form id="form-produto" class="space-y-3">
      <input id="nome" type="text" placeholder="Nome do produto" class="w-full px-3 py-2 border rounded" required />
      <input id="preco" type="number" step="0.01" placeholder="Preço" class="w-full px-3 py-2 border rounded" required />
      <input id="img" type="url" placeholder="URL da imagem" class="w-full px-3 py-2 border rounded" required oninput="previewImagem()" />
      <img id="preview" src="" alt="Prévia da imagem" class="hidden w-32 h-32 object-cover rounded mx-auto border" />
      <div class="flex justify-end space-x-3 pt-3">
        <button type="button" onclick="fecharPopup()" class="px-4 py-2 rounded border">Cancelar</button>
        <button type="submit" class="px-4 py-2 rounded font-semibold"
          style="background: rgb(253,219,87); color: rgb(36,59,151);">Salvar</button>
      </div>
    </form>
  </div>
</div>

<script>
let produtos = JSON.parse(localStorage.getItem("produtos")) || [];
let pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];

// Abas
const abaProdutos = document.getElementById("aba-produtos");
const abaPedidos = document.getElementById("aba-pedidos");
const btnProdutos = document.getElementById("btn-produtos");
const btnPedidos = document.getElementById("btn-pedidos");

btnProdutos.addEventListener("click", ()=>{
  abaProdutos.classList.remove("hidden");
  abaPedidos.classList.add("hidden");
  btnProdutos.style.background = "rgb(253,219,87)";
  btnProdutos.style.color = "rgb(36,59,151)";
  btnPedidos.style.background = "white";
  btnPedidos.style.borderColor = "rgb(36,59,151)";
});
btnPedidos.addEventListener("click", ()=>{
  abaPedidos.classList.remove("hidden");
  abaProdutos.classList.add("hidden");
  btnPedidos.style.background = "rgb(253,219,87)";
  btnPedidos.style.color = "rgb(36,59,151)";
  btnProdutos.style.background = "white";
  btnProdutos.style.borderColor = "rgb(36,59,151)";
});

// Popup Produto
function abrirPopup(){ document.getElementById("popup").classList.remove("hidden"); }
function fecharPopup(){
  document.getElementById("popup").classList.add("hidden");
  document.getElementById("form-produto").reset();
  document.getElementById("preview").classList.add("hidden");
}
function previewImagem(){
  const url = document.getElementById("img").value;
  const preview = document.getElementById("preview");
  if(url){ preview.src = url; preview.classList.remove("hidden"); }
  else{ preview.classList.add("hidden"); }
}

// Adicionar Produto
document.getElementById("form-produto").addEventListener("submit", e=>{
  e.preventDefault();
  const nome = document.getElementById("nome").value;
  const preco = parseFloat(document.getElementById("preco").value);
  const img = document.getElementById("img").value;
  const id = Date.now();
  produtos.push({id,nome,preco,img,estoque:true});
  localStorage.setItem("produtos",JSON.stringify(produtos));
  fecharPopup();
  renderProdutos();
});

// Render Produtos
function renderProdutos(){
  const lista = document.getElementById("lista-produtos");
  lista.innerHTML="";
  produtos.forEach((p,i)=>{
    const card = document.createElement("div");
    card.className="border rounded-lg shadow p-3 flex flex-col items-center text-center bg-white";
    card.innerHTML=`
      <img src="${p.img}" class="w-32 h-32 object-cover rounded mb-2 border" />
      <h3 class="font-semibold">${p.nome}</h3>
      <p class="text-sm mb-2">R$ ${p.preco.toFixed(2)}</p>
      <span class="text-xs px-2 py-1 rounded mb-2 ${p.estoque ? 'bg-green-200 text-green-700' : 'bg-red-200 text-red-700'}">
        ${p.estoque ? 'Em estoque' : 'Fora de estoque'}
      </span>
      <div class="flex space-x-2">
        <button onclick="toggleEstoque(${i})" class="text-sm px-3 py-1 rounded"
          style="background: rgb(253,219,87); color: rgb(36,59,151);">
          ${p.estoque ? 'Fora de estoque' : 'Em estoque'}
        </button>
        <button onclick="removerProduto(${i})" class="text-sm px-3 py-1 rounded bg-red-500 text-white">
          Excluir
        </button>
      </div>
    `;
    lista.appendChild(card);
  });
}
function removerProduto(i){ produtos.splice(i,1); localStorage.setItem("produtos",JSON.stringify(produtos)); renderProdutos(); }
function toggleEstoque(i){ produtos[i].estoque = !produtos[i].estoque; localStorage.setItem("produtos",JSON.stringify(produtos)); renderProdutos(); }

// Render Pedidos
function renderPedidos(){
  const pendentesDiv = document.getElementById("pedidos-pendentes");
  const confirmadosDiv = document.getElementById("pedidos-confirmados");
  pendentesDiv.innerHTML = "";
  confirmadosDiv.innerHTML = "";

  pedidos.forEach((pedido,i)=>{
    const div = document.createElement("div");
    div.className="border rounded-lg p-4 bg-white shadow";
    let itensHtml = pedido.itens.map(it => `<p>${it.nome} x${it.qtd} — R$ ${(it.preco*it.qtd).toFixed(2)}</p>`).join("");
    div.innerHTML = `
      <p class="text-sm mb-1">Data: ${pedido.data}</p>
      <div class="mb-2">${itensHtml}</div>
      <p class="font-semibold mb-2">Total: R$ ${pedido.total.toFixed(2)}</p>
      <p class="mb-2">Pagamento: ${pedido.pagamento}</p>
      <div class="flex space-x-2">
        ${pedido.status==="Pendente" ? `<button onclick="confirmarPedido(${i})" class="px-3 py-1 rounded font-semibold" style="background: rgb(253,219,87); color: rgb(36,59,151);">Confirmar</button>` : ""}
        <button onclick="excluirPedido(${i})" class="px-3 py-1 rounded bg-red-500 text-white">Excluir</button>
      </div>
    `;
    if(pedido.status==="Pendente"){ pendentesDiv.appendChild(div); }
    else{ confirmadosDiv.appendChild(div); }
  });
}
function confirmarPedido(i){ pedidos[i].status="Confirmado"; localStorage.setItem("pedidos",JSON.stringify(pedidos)); renderPedidos(); }
function excluirPedido(i){ if(confirm("Deseja realmente excluir este pedido?")){ pedidos.splice(i,1); localStorage.setItem("pedidos",JSON.stringify(pedidos)); renderPedidos(); } }

renderProdutos();
renderPedidos();
</script>

</body>
</html>
